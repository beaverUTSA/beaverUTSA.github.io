<style>
p{
  white-space: pre-wrap;
}
.content {
  max-width: 960px;
  margin: auto;
}
pre code {
  background-color: #eee;
  border: 1px solid #999;
  display: block;
  padding: 20px;
}
</style>
<div class="content">
  <h1>Hello!</h1>
  <h1>Question 1</h1>
  <p>
Given a table that holds websites (WEBSITE_ID, Name, URL), website pages (PAGE_ID, WEBSITE_ID, path), and website vulnerabilities (VULN_ID, PAGE_ID, data), find all of the vulnerabilities on website foo.com that pertain to the login page login.html. Your SQL should be performant for larger data sets.


Table websites:
WEBSITE_ID, Name, URL
1. foo, http://foo.com
2. bar, http://foo.com <strong>should it be http://bar.com?</strong>

Table pages:
PAGE_ID, WEBSITE_ID, path
1, 1, /login.html
2, 1, /logout.html
3, 1, /admin.html
4, 2, /login.html
5, 2, /logout.html
6, 2, /admin.html

Table vulnerabilities
VULN_ID, PAGE_ID, data
1, 1, SQL injection response blah
2, 1, XXE response
3, 1, Stored XSS response
4, 2, Session hijack
5, 4, XXE response
6, 6, Default credentials resposne

Input:
All vulnerabilities for foo.com on login.html page
Output:
1, 1, SQL injection response blah
2, 1, XXE response
3, 1, Stored XSS response
  </p>
  <pre>
    <code>
    <strong>--SQL Solution</strong>
    
    SELECT VULN_ID, PAGE_ID, data
    FROM vulnerabilities
    WHERE PAGE_ID IN (
    	SELECT PAGE_ID 
	FROM pages 
        WHERE WEBSITE_ID IN (
		SELECT WEBSITE_ID 
       		FROM websites 
		WHERE Name = "foo") 
	AND path LIKE '%login.html%');
    </code>
  </pre>
  <qanda>
	  How do we make this performant when we have 10 billion unique vulnerabilities across hundreds of thousands of websites?<br><br>
	  <strong>    I would recommend to make a unique key from the websites and pages tables and add that to a column in the vulnerabilities table.<br><br>
	  So given a website and page, a unique value would be generated, that value could be on its own table or calculated before hitting the database.<br><br>
	  The downside to this speedup would be the maintenace and space needed for those tables, like what if a new page is added or new vulnerabilites are found?
	  And what if the name of the website changes? <br><br>The lookup tables would need to be updated to be accurate.
	  </strong>
  </qanda>
  
  <h1>Question 2</h1>
  <p>
Write a function that takes two lists as input and produces one list as output. The function should have the signature `def apply_port_exclusions(include_ports, exclude_ports)`. The function should expect that the input lists will be a list of low-high pairs which are lists of length two. The function should return a minimized and ordered list of include port ranges that result after processing the exclude port ranges.

Include whatever tests and comments you normally provide for completed code.

Examples:
input:
include_ports: [[80, 80], [22, 23], [8000, 9000]]
exclude_ports: [[1024, 1024], [8080, 8080]]
output:
[[22, 23], [80, 80], [8000, 8079], [8081, 9000]]

input:
include_ports: [[8000, 9000], [80, 80], [22, 23]]
exclude_ports: [[1024, 1024], [8080, 8080]]
output:
[[22, 23], [80, 80], [8000, 8079], [8081, 9000]]

input:
include_ports: [[1,65535]]
exclude_ports: [[1000,2000], [500, 2500]]
output:
[[1, 499], [2501, 65535]]

input:
include_ports: [[1,1], [3, 65535], [2, 2]]
exclude_ports: [[1000, 2000], [500, 2500]]
output:
[[1, 499], [2501, 65535]]

input:
include_ports: []
exclude_ports: [[8080, 8080]]
output:
[] 
  </p>
</div>
